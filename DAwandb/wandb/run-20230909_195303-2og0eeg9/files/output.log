Using cpu device
NeuralNetwork(
  (flatten): Flatten(start_dim=1, end_dim=-1)
  (linear_relu_stack): Sequential(
    (0): Linear(in_features=784, out_features=512, bias=True)
    (1): ReLU()
    (2): Linear(in_features=512, out_features=512, bias=True)
    (3): ReLU()
    (4): Linear(in_features=512, out_features=10, bias=True)
  )
)
Epoch 1
-------------------------------
loss: 2.300334  [    0/60000]
loss: 2.289012  [ 6400/60000]
 19%|███████████████████████████▊                                                                                                                          | 174/938 [00:01<00:07, 108.29it/s]
loss: 2.265615  [12800/60000]

 42%|███████████████████████████████████████████████████████████████▍                                                                                      | 397/938 [00:03<00:04, 108.48it/s]
loss: 2.251758  [25600/60000]
loss: 2.211386  [32000/60000]

 64%|████████████████████████████████████████████████████████████████████████████████████████████████▍                                                      | 599/938 [00:05<00:03, 97.80it/s]
loss: 2.180894  [44800/60000]

 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                    | 808/938 [00:07<00:01, 106.49it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:08<00:00, 104.83it/s]
 87%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                    | 136/157 [00:00<00:00, 168.18it/s]
Test Error:
 Accuracy: 49.2%, Avg loss: 2.144628
Epoch 2
-------------------------------
loss: 2.154544  [    0/60000]
loss: 2.143306  [ 6400/60000]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 157/157 [00:00<00:00, 166.38it/s]
 22%|████████████████████████████████▉                                                                                                                     | 206/938 [00:01<00:06, 106.40it/s]
loss: 2.100264  [19200/60000]

 45%|███████████████████████████████████████████████████████████████████▋                                                                                  | 423/938 [00:03<00:04, 108.83it/s]
loss: 1.979137  [32000/60000]

 68%|██████████████████████████████████████████████████████████████████████████████████████████████████████▏                                               | 639/938 [00:05<00:02, 104.63it/s]
loss: 1.927539  [44800/60000]

 92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 860/938 [00:07<00:00, 111.86it/s]
loss: 1.862038  [57600/60000]
Test Error:
 Accuracy: 52.4%, Avg loss: 1.859324
Epoch 3
-------------------------------
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:08<00:00, 108.34it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 157/157 [00:00<00:00, 169.03it/s]

 23%|███████████████████████████████████                                                                                                                    | 218/938 [00:02<00:09, 79.92it/s]
loss: 1.861315  [ 6400/60000]

 38%|█████████████████████████████████████████████████████████▋                                                                                             | 358/938 [00:04<00:08, 70.41it/s]

 59%|████████████████████████████████████████████████████████████████████████████████████████▊                                                             | 555/938 [00:06<00:03, 100.86it/s]
loss: 1.666612  [25600/60000]

 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                           | 767/938 [00:08<00:01, 106.78it/s]
loss: 1.650306  [38400/60000]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:10<00:00, 93.61it/s]
 43%|████████████████████████████████████████████████████████████████▍                                                                                      | 67/157 [00:00<00:00, 165.75it/s]
loss: 1.591836  [51200/60000]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 157/157 [00:00<00:00, 165.27it/s]
 18%|██████████████████████████▍                                                                                                                           | 165/938 [00:01<00:07, 106.96it/s]
Test Error:
 Accuracy: 59.9%, Avg loss: 1.490867
Epoch 4
-------------------------------
loss: 1.562228  [    0/60000]

 40%|████████████████████████████████████████████████████████████▌                                                                                         | 379/938 [00:03<00:05, 108.35it/s]
loss: 1.370528  [12800/60000]

 63%|██████████████████████████████████████████████████████████████████████████████████████████████▋                                                        | 588/938 [00:05<00:03, 98.47it/s]
loss: 1.327183  [25600/60000]

 85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                      | 797/938 [00:07<00:01, 107.34it/s]
loss: 1.347525  [38400/60000]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:08<00:00, 104.85it/s]
 65%|█████████████████████████████████████████████████████████████████████████████████████████████████▍                                                    | 102/157 [00:00<00:00, 162.81it/s]
loss: 1.316897  [51200/60000]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 157/157 [00:00<00:00, 162.90it/s]
 19%|████████████████████████████▊                                                                                                                         | 180/938 [00:01<00:07, 107.07it/s]
Test Error:
 Accuracy: 63.3%, Avg loss: 1.234476
Epoch 5
-------------------------------
loss: 1.310838  [    0/60000]

 43%|████████████████████████████████████████████████████████████████▌                                                                                     | 404/938 [00:03<00:04, 107.17it/s]
loss: 1.122594  [12800/60000]

 66%|██████████████████████████████████████████████████████████████████████████████████████████████████▎                                                   | 615/938 [00:05<00:03, 102.88it/s]
loss: 1.109603  [25600/60000]
loss: 1.137849  [32000/60000]

 88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                  | 824/938 [00:07<00:01, 103.16it/s]
loss: 1.100280  [44800/60000]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 938/938 [00:08<00:00, 105.93it/s]
  0%|                                                                                                                                                                 | 0/157 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/Users/kimkirok/projects/wandb/DAwandb/main.py", line 156, in <module>
    main()
  File "/Users/kimkirok/projects/wandb/DAwandb/main.py", line 152, in main
    run(opt)
  File "/Users/kimkirok/projects/wandb/DAwandb/main.py", line 118, in run
    test(test_dataloader, model, loss_fn, t,log_images=(t==(epochs-1)))
  File "/Users/kimkirok/projects/wandb/DAwandb/main.py", line 100, in test
    log_image_table(X, predicted, y, pred.softmax(dim=1))
                       ^^^^^^^^^
NameError: cannot access free variable 'predicted' where it is not associated with a value in enclosing scope
loss: 1.057536  [57600/60000]